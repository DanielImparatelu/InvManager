package com.github.invmanager.dal;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

public class ItemsDAOImpl implements ItemsDAO {

	@Override
	public List<Items> getAllItems() {
		DataSource ds = new DataSource();
		Connection con = ds.createConnection();//creates the connection to the database using the DataSource object
		PreparedStatement ps = null;//instantiating the PreparedStatement and ResultSet to null so they can be closed easily later
		ResultSet rs = null;
		
		List<Items> itemList = new ArrayList<Items>();//creates an array to hold the information
		
		try {
			ps = con.prepareStatement("SELECT * FROM ITEMS_DATA");//SQL query-selects everything from that table
			rs = ps.executeQuery();//executes the above query
			while(rs.next()) {//loops through the resultset and retrieves the data
				Items items = new Items();
				
				items.setItemID(rs.getInt("Item_ID"));
				items.setItemName(rs.getString("Item_Name"));
				items.setItemQty(rs.getInt("Item_Quantity"));
				items.setItemExpDate(rs.getDate("Item_Exp_Date"));
				items.setItemLastRestocked(rs.getDate("Item_Last_Restocked"));
				
				itemList.add(items);//and adds it to the arraylist
			}
		}
		catch(SQLException e) {
			e.printStackTrace();//exception handling
		}
		finally {//block responsible for closing the connection and objects used
			try {
				if(con != null) {
					con.close();
				}
				if(ps != null) {
					ps.close();
				}
				if(rs != null) {
					rs.close();
				}
			}
			catch(Exception ex) {
				ex.printStackTrace();
			}
		}
		return itemList;
	}

	@Override
	public Items getItem(int itemID) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public void addItem(Items item) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void updateItems(Items items) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void deleteItems(int itemID) {
		// TODO Auto-generated method stub
		
	}

}
